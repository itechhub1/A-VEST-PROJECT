"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.roleBased = void 0;
var bad_request_error_1 = require("../errors/bad-request-error");
exports.roleBased = function (role) { return function (req, res, next) {
    var _a;
    var userRole = (_a = req.currentUser) === null || _a === void 0 ? void 0 : _a.role;
    //@ts-ignore
    if (!role.includes(userRole)) {
        throw new bad_request_error_1.BadRequestError("unAuthorized");
    }
    else {
        return next();
    }
}; };
